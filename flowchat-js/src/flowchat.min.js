"use strict";(function($){$.fn.flowchat=function(options){var settings=$.extend({delay:1500,startButtonId:'#startButton',autoStart:!0,startMessageId:1,dataJSON:null},options);var container=$(this);$(function(){if(settings.autoStart)
startChat(container,settings.dataJSON,settings.startMessageId,settings.delay)});$(document).on('click','.options li',function(){$(this).parent().hide();var userReply='<li class="user"><div class="text">'+$(this).html()+'</div></li>';container.children('.chat-window').append(userReply);var messages=settings.dataJSON;var nextMessageId=$(this).attr('data-nextId');var nextMessage=findMessageInJsonById(messages,nextMessageId);generateMessageHTML(container,messages,nextMessage,settings.delay)});$(document).on('click',settings.startButtonId,function(){startChat(container,settings.dataJSON,settings.startMessageId,settings.delay)})}
function startChat(container,data,startId,delay){container.html("");container.append("<ul class='chat-window'></ul>");var message=findMessageInJsonById(data,startId);generateMessageHTML(container,data,message,delay)}
function findMessageInJsonById(data,id){var messages=data;for(var i=0;messages.length>i;i ++)
if(messages[i].id==id)
return messages[i]}
function addOptions(m){var template='<li class="options"><ul>';var optionText=null;var optionMessageId=null;for(var i=1;i<6;i++){optionText=m["option"+i]
optionMessageId=m["option"+i+"_nextMessageId"]
if(optionText!=""&&optionText!=undefined&&optionText!=null)
template=template+"<li data-nextId="+optionMessageId+">"+optionText+"</li>"}
template=template+'</ul></li>';return template}
function toggleLoader(status,container){if(status=="show")
container.children('.chat-window').append("<li class='typing-indicator'><span></span><span></span><span></span></li>");else container.find('.typing-indicator').remove()}
function generateMessageHTML(container,messages,m,delay){var template='<li class="bot"><div class="text">'+m.text+'</div></li>';if(m.messageType=="Question")
template=template+addOptions(m);toggleLoader("show",container);container.children(".chat-window").scrollTop($(".chat-window").prop('scrollHeight'));setTimeout(function(){toggleLoader("hide",container);container.children('.chat-window').append(template);container.children(".chat-window").scrollTop($(".chat-window").prop('scrollHeight'));if(m.nextMessageId!=""){var nextMessage=findMessageInJsonById(messages,m.nextMessageId)
generateMessageHTML(container,messages,nextMessage,delay)}},delay)}}(jQuery))